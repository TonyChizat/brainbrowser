#!/bin/bash

APP_ROOT=`pwd`

COMPRESSOR="java -jar $APP_ROOT/script/yuicompressor-2.4.7.jar"

cd $APP_ROOT/development/public/js
cat $APP_ROOT/license_header.txt lib/utils.js lib/color.js lib/spectrum.js brainbrowser/brainbrowser.js brainbrowser/modules/* brainbrowser/data/data.js brainbrowser/filetypes/* surfview.js > /tmp/surface-combined.js
$COMPRESSOR /tmp/surface-combined.js -o $APP_ROOT/production/public/js/surfview-combined.min.js
rm /tmp/surface-combined.js
cat $APP_ROOT/license_header.txt lib/utils.js lib/color.js lib/spectrum.js brainbrowser/brainbrowser.js brainbrowser/modules/* brainbrowser/data/data.js brainbrowser/filetypes/* macacc/macacc.js macaccview.js > /tmp/macaccview-combined.js
$COMPRESSOR /tmp/macaccview-combined.js -o $APP_ROOT/production/public/js/macaccview-combined.min.js
rm /tmp/macaccview-combined.js
cat $APP_ROOT/license_header.txt lib/utils.js lib/color.js lib/spectrum.js braincanvas/* braincanvas.js > /tmp/html5-minc-viewer.js
$COMPRESSOR /tmp/html5-minc-viewer.js -o $APP_ROOT/production/public/js/html5-minc-viewer.min.js
cat $APP_ROOT/license_header.txt layout.js > /tmp/layout.js
$COMPRESSOR /tmp/layout.js -o $APP_ROOT/production/public/js/layout.js
cat $APP_ROOT/license_header.txt lib/ui.js > /tmp/ui.js
$COMPRESSOR /tmp/ui.js -o $APP_ROOT/production/public/js/lib/ui.js
cat $APP_ROOT/license_header.txt brainbrowser/modules/brainbrowser.utils.js > /tmp/brainbrowser.utils.js
$COMPRESSOR /tmp/brainbrowser.utils.js -o $APP_ROOT/production/public/js/lib/brainbrowser.utils.js
cat $APP_ROOT/license_header.txt workers/mniobj.worker.js > /tmp/mniobj.worker.js
$COMPRESSOR /tmp/mniobj.worker.js -o $APP_ROOT/production/public/js/workers/mniobj.worker.js
cat $APP_ROOT/license_header.txt workers/wavefront_obj.worker.js > /tmp/wavefront_obj.worker.js
$COMPRESSOR /tmp/wavefront_obj.worker.js -o $APP_ROOT/production/public/js/workers/wavefront_obj.worker.js
cat $APP_ROOT/license_header.txt workers/freesurfer_asc.worker.js > /tmp/freesurfer_asc.worker.js
$COMPRESSOR /tmp/freesurfer_asc.worker.js -o $APP_ROOT/production/public/js/workers/freesurfer_asc.worker.js
cat $APP_ROOT/license_header.txt workers/data.worker.js > /tmp/data.worker.js
$COMPRESSOR /tmp/data.worker.js -o $APP_ROOT/production/public/js/workers/data.worker.js
